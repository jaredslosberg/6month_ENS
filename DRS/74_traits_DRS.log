
R version 4.0.2 (2020-06-22) -- "Taking Off Again"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> rmarkdown::render(input = '74_traits_DRS.Rmd', output_file = '74_traits_DRS.html')


processing file: 74_traits_DRS.Rmd
  |                                                                              |                                                                      |   0%  |                                                                              |........                                                              |  11%
  ordinary text without R code

  |                                                                              |................                                                      |  22%
label: unnamed-chunk-1 (with options) 
List of 2
 $ message: logi FALSE
 $ results: chr "hide"

Loading required package: Biobase
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: 'BiocGenerics'

The following objects are masked from 'package:parallel':

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs

The following objects are masked from 'package:base':

    anyDuplicated, append, as.data.frame, basename, cbind, colnames,
    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,
    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,
    union, unique, unsplit, which.max, which.min

Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.

Loading required package: SingleCellExperiment
Loading required package: SummarizedExperiment
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: 'matrixStats'

The following objects are masked from 'package:Biobase':

    anyMissing, rowMedians


Attaching package: 'MatrixGenerics'

The following objects are masked from 'package:matrixStats':

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

The following object is masked from 'package:Biobase':

    rowMedians

Loading required package: GenomicRanges
Loading required package: stats4
Loading required package: S4Vectors

Attaching package: 'S4Vectors'

The following object is masked from 'package:base':

    expand.grid

Loading required package: IRanges
Loading required package: GenomeInfoDb

Attaching package: 'monocle3'

The following objects are masked from 'package:Biobase':

    exprs, fData, fData<-, pData, pData<-

── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──
✔ tibble  3.1.3     ✔ dplyr   1.0.7
✔ tidyr   1.1.3     ✔ stringr 1.4.0
✔ readr   1.4.0     ✔ forcats 0.5.1
✔ purrr   0.3.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::collapse()   masks IRanges::collapse()
✖ dplyr::combine()    masks Biobase::combine(), BiocGenerics::combine()
✖ dplyr::count()      masks matrixStats::count()
✖ dplyr::desc()       masks IRanges::desc()
✖ tidyr::expand()     masks S4Vectors::expand()
✖ dplyr::filter()     masks stats::filter()
✖ dplyr::first()      masks S4Vectors::first()
✖ dplyr::lag()        masks stats::lag()
✖ ggplot2::Position() masks BiocGenerics::Position(), base::Position()
✖ purrr::reduce()     masks GenomicRanges::reduce(), IRanges::reduce()
✖ dplyr::rename()     masks S4Vectors::rename()
✖ dplyr::slice()      masks IRanges::slice()
here() starts at /data/users/jared/ENS/6mo_LMMP
  |                                                                              |.......................                                               |  33%
  ordinary text without R code

  |                                                                              |...............................                                       |  44%
label: unnamed-chunk-2
  |                                                                              |.......................................                               |  56%
  ordinary text without R code

  |                                                                              |...............................................                       |  67%
label: unnamed-chunk-3
  |                                                                              |......................................................                |  78%
  ordinary text without R code

  |                                                                              |..............................................................        |  89%
label: unnamed-chunk-4
/home/jared/.cache/basilisk/1.2.1/zellkonverter-1.0.3/anndata_env/lib/python3.7/site-packages/anndata/_core/anndata.py:1192: FutureWarning: is_categorical is deprecated and will be removed in a future version.  Use is_categorical_dtype instead
  if is_string_dtype(df[key]) and not is_categorical(df[key])
... storing 'barcode' as categorical
... storing 'sample' as categorical
... storing 'batch' as categorical
... storing 'cell_type' as categorical
... storing 'cell_type_factor_color' as categorical
... storing 'ganglia_ct_color' as categorical
  |                                                                              |......................................................................| 100%
  ordinary text without R code


output file: 74_traits_DRS.knit.md

/home/jared/anaconda3/envs/scRNA/bin/pandoc +RTS -K512m -RTS 74_traits_DRS.knit.md --to html4 --from markdown+autolink_bare_uris+tex_math_single_backslash --output 74_traits_DRS.html --lua-filter /home/jared/R/x86_64-pc-linux-gnu-library/4.0/rmarkdown/rmarkdown/lua/pagebreak.lua --lua-filter /home/jared/R/x86_64-pc-linux-gnu-library/4.0/rmarkdown/rmarkdown/lua/latex-div.lua --self-contained --variable bs3=TRUE --standalone --section-divs --template /home/jared/R/x86_64-pc-linux-gnu-library/4.0/rmarkdown/rmd/h/default.html --no-highlight --variable highlightjs=1 --variable theme=bootstrap --include-in-header /tmp/RtmpiUInAR/rmarkdown-str1bf30827b76013.html --mathjax --variable 'mathjax-url:https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' --variable code_folding=show --variable source_embed=74_traits_DRS.Rmd --include-after-body /tmp/RtmpiUInAR/file1bf3083255ba0f.html --variable code_menu=1 --variable kable-scroll=1 

Output created: 74_traits_DRS.nb.html
> 
> 
******************************************************************************
* Single-cell disease relevance score (scDRS)
* Version beta
* Martin Jinye Zhang and Kangcheng Hou
* HSPH / Broad Institute / UCLA
* MIT License
******************************************************************************
Call: ./compute_score.py \
--h5ad_file ../6month_LMMP.h5ad\
--h5ad_species mmusculus\
--cov_file ./data/lmmp_covar.tsv\
--gs_file ./data/gs_file/magma_10kb_1000.74_traits.gs\
--gs_species hsapiens\
--ctrl_match_opt mean_var\
--weight_opt vs\
--flag_filter True\
--flag_raw_count True\
--n_ctrl 1000\
--flag_return_ctrl_raw_score False\
--flag_return_ctrl_norm_score True\
--out_folder ./out

Load data:
--h5ad_file loaded: n_cell=6942, n_gene=11368 (sys_time=1.6s)
--cov_file loaded: covariates=[batch_recode, num_genes_expressed] (sys_time=1.7s)
Regress out covariates from --h5ad_file (sys_time=5.1s)
--gs_file loaded: n_geneset=74 (sys_time=5.1s)
--gs_file converted from hsapiens to mmusculus genes (sys_time=5.2s)

Compute cell-level and gene-level statistics:

Compute: score:
Gene set PASS_ADHD_Demontis2018 (n_gene=570): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=188.7s)
Gene set PASS_Alzheimers_Jansen2019 (n_gene=563): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=365.6s)
Gene set PASS_AtrialFibrillation_Nielsen2018 (n_gene=586): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=547.6s)
Gene set PASS_BIP_Stahl2019 (n_gene=562): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=724.9s)
Gene set PASS_CD_deLange2017 (n_gene=599): 0/6942 FDR<0.1 cells, 5/6942 FDR<0.2 cells (sys_time=909.7s)
Gene set PASS_Celiac (n_gene=541): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=1081.9s)
Gene set PASS_Coronary_Artery_Disease (n_gene=580): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=1262.8s)
Gene set PASS_DrinksPerWeek_Liu2019 (n_gene=585): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=1444.6s)
Gene set PASS_FastingGlucose_Manning (n_gene=554): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=1620.0s)
Gene set PASS_GeneralRiskTolerance_KarlssonLinner2019 (n_gene=568): 0/6942 FDR<0.1 cells, 1/6942 FDR<0.2 cells (sys_time=1797.1s)
Gene set PASS_IBD_deLange2017 (n_gene=589): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=1980.4s)
Gene set PASS_Insomnia_Jansen2019 (n_gene=558): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=2157.2s)
Gene set PASS_Intelligence_SavageJansen2018 (n_gene=597): 1/6942 FDR<0.1 cells, 1/6942 FDR<0.2 cells (sys_time=2343.7s)
Gene set PASS_Lupus (n_gene=577): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=2523.3s)
Gene set PASS_MDD_Howard2019 (n_gene=567): 0/6942 FDR<0.1 cells, 9/6942 FDR<0.2 cells (sys_time=2700.7s)
Gene set PASS_Multiple_sclerosis (n_gene=594): 4/6942 FDR<0.1 cells, 7/6942 FDR<0.2 cells (sys_time=2883.4s)
Gene set PASS_Primary_biliary_cirrhosis (n_gene=593): 2/6942 FDR<0.1 cells, 2/6942 FDR<0.2 cells (sys_time=3067.1s)
Gene set PASS_ReactionTime_Davies2018 (n_gene=585): 0/6942 FDR<0.1 cells, 11/6942 FDR<0.2 cells (sys_time=3248.9s)
Gene set PASS_Rheumatoid_Arthritis (n_gene=563): 2/6942 FDR<0.1 cells, 8/6942 FDR<0.2 cells (sys_time=3427.6s)
Gene set PASS_SWB (n_gene=519): 0/6942 FDR<0.1 cells, 3/6942 FDR<0.2 cells (sys_time=3595.7s)
Gene set PASS_Schizophrenia_Pardinas2018 (n_gene=601): 1/6942 FDR<0.1 cells, 1/6942 FDR<0.2 cells (sys_time=3780.6s)
Gene set PASS_SleepDuration_Dashti2019 (n_gene=572): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=3965.9s)
Gene set PASS_Type_1_Diabetes (n_gene=548): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=4140.3s)
Gene set PASS_Type_2_Diabetes (n_gene=572): 0/6942 FDR<0.1 cells, 1/6942 FDR<0.2 cells (sys_time=4325.1s)
Gene set PASS_UC_deLange2017 (n_gene=571): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=4520.8s)
Gene set PASS_VerbalNumericReasoning_Davies2018 (n_gene=608): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=4722.5s)
Gene set PASS_Worry_Nagel2018 (n_gene=589): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=4920.0s)
Gene set UKB_460K.biochemistry_AlanineAminotransferase (n_gene=613): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=5123.0s)
Gene set UKB_460K.biochemistry_AlkalinePhosphatase (n_gene=603): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=5322.2s)
Gene set UKB_460K.biochemistry_Cholesterol (n_gene=577): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=5507.7s)
Gene set UKB_460K.biochemistry_Glucose (n_gene=551): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=5688.2s)
Gene set UKB_460K.biochemistry_HDLcholesterol (n_gene=572): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=5878.5s)
Gene set UKB_460K.biochemistry_HbA1c (n_gene=582): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=6071.8s)
Gene set UKB_460K.biochemistry_LDLdirect (n_gene=596): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=6267.6s)
Gene set UKB_460K.biochemistry_SHBG (n_gene=602): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=6466.6s)
Gene set UKB_460K.biochemistry_Testosterone_Male (n_gene=558): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=6655.7s)
Gene set UKB_460K.biochemistry_TotalBilirubin (n_gene=569): 0/6942 FDR<0.1 cells, 1/6942 FDR<0.2 cells (sys_time=6847.6s)
Gene set UKB_460K.biochemistry_TotalProtein (n_gene=623): 0/6942 FDR<0.1 cells, 6/6942 FDR<0.2 cells (sys_time=7057.4s)
Gene set UKB_460K.biochemistry_Triglycerides (n_gene=604): 1/6942 FDR<0.1 cells, 1/6942 FDR<0.2 cells (sys_time=7248.8s)
Gene set UKB_460K.blood_EOSINOPHIL_COUNT (n_gene=623): 4/6942 FDR<0.1 cells, 29/6942 FDR<0.2 cells (sys_time=7460.9s)
Gene set UKB_460K.blood_LYMPHOCYTE_COUNT (n_gene=597): 14/6942 FDR<0.1 cells, 36/6942 FDR<0.2 cells (sys_time=7653.4s)
Gene set UKB_460K.blood_MEAN_CORPUSCULAR_HEMOGLOBIN (n_gene=592): 0/6942 FDR<0.1 cells, 2/6942 FDR<0.2 cells (sys_time=7844.7s)
Gene set UKB_460K.blood_MONOCYTE_COUNT (n_gene=604): 1/6942 FDR<0.1 cells, 15/6942 FDR<0.2 cells (sys_time=8039.8s)
Gene set UKB_460K.blood_PLATELET_COUNT (n_gene=612): 1/6942 FDR<0.1 cells, 1/6942 FDR<0.2 cells (sys_time=8236.7s)
Gene set UKB_460K.blood_RBC_DISTRIB_WIDTH (n_gene=597): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=8437.4s)
Gene set UKB_460K.blood_RED_COUNT (n_gene=608): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=8632.5s)
Gene set UKB_460K.blood_WHITE_COUNT (n_gene=662): 2/6942 FDR<0.1 cells, 2/6942 FDR<0.2 cells (sys_time=8838.1s)
Gene set UKB_460K.bmd_HEEL_TSCOREz (n_gene=618): 0/6942 FDR<0.1 cells, 1/6942 FDR<0.2 cells (sys_time=9047.5s)
Gene set UKB_460K.body_BALDING1 (n_gene=588): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=9275.7s)
Gene set UKB_460K.body_BMIz (n_gene=616): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=9509.7s)
Gene set UKB_460K.body_HEIGHTz (n_gene=593): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=9739.0s)
Gene set UKB_460K.body_WHRadjBMIz (n_gene=615): 0/6942 FDR<0.1 cells, 5/6942 FDR<0.2 cells (sys_time=9973.9s)
Gene set UKB_460K.bp_DIASTOLICadjMEDz (n_gene=611): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=10208.0s)
Gene set UKB_460K.bp_SYSTOLICadjMEDz (n_gene=622): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=10444.7s)
Gene set UKB_460K.cancer_BREAST (n_gene=534): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=10657.9s)
Gene set UKB_460K.cov_EDU_COLLEGE (n_gene=574): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=10881.8s)
Gene set UKB_460K.cov_EDU_YEARS (n_gene=548): 0/6942 FDR<0.1 cells, 2/6942 FDR<0.2 cells (sys_time=11098.8s)
Gene set UKB_460K.cov_SMOKING_STATUS (n_gene=572): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=11321.3s)
Gene set UKB_460K.disease_AID_ALL (n_gene=597): 1/6942 FDR<0.1 cells, 8/6942 FDR<0.2 cells (sys_time=11550.1s)
Gene set UKB_460K.disease_ALLERGY_ECZEMA_DIAGNOSED (n_gene=594): 1/6942 FDR<0.1 cells, 2/6942 FDR<0.2 cells (sys_time=11779.7s)
Gene set UKB_460K.disease_ASTHMA_DIAGNOSED (n_gene=604): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=12012.5s)
Gene set UKB_460K.disease_CARDIOVASCULAR (n_gene=604): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=12243.4s)
Gene set UKB_460K.disease_HYPERTENSION_DIAGNOSED (n_gene=590): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=12476.9s)
Gene set UKB_460K.disease_HYPOTHYROIDISM_SELF_REP (n_gene=633): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=12715.3s)
Gene set UKB_460K.disease_RESPIRATORY_ENT (n_gene=595): 2/6942 FDR<0.1 cells, 5/6942 FDR<0.2 cells (sys_time=12945.1s)
Gene set UKB_460K.impedance_BASAL_METABOLIC_RATEz (n_gene=607): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=13177.1s)
Gene set UKB_460K.lung_FEV1FVCzSMOKE (n_gene=651): 1/6942 FDR<0.1 cells, 2/6942 FDR<0.2 cells (sys_time=13423.0s)
Gene set UKB_460K.lung_FVCzSMOKE (n_gene=597): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=13654.4s)
Gene set UKB_460K.mental_NEUROTICISM (n_gene=573): 1/6942 FDR<0.1 cells, 11/6942 FDR<0.2 cells (sys_time=13878.8s)
Gene set UKB_460K.other_MORNINGPERSON (n_gene=560): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=14100.4s)
Gene set UKB_460K.pigment_HAIR (n_gene=570): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=14323.2s)
Gene set UKB_460K.repro_MENARCHE_AGE (n_gene=570): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=14547.4s)
Gene set UKB_460K.repro_MENOPAUSE_AGE (n_gene=587): 1/6942 FDR<0.1 cells, 2/6942 FDR<0.2 cells (sys_time=14774.0s)
Gene set UKB_460K.repro_NumberChildrenEverBorn_Pooled (n_gene=559): 0/6942 FDR<0.1 cells, 0/6942 FDR<0.2 cells (sys_time=14993.2s)

******************************************************************************
* Single-cell disease relevance score (scDRS)
* Version beta
* Martin Jinye Zhang and Kangcheng Hou
* HSPH / Broad Institute / UCLA
* MIT License
******************************************************************************
Call: ./compute_score.py \
--h5ad_file ../TC_LMMP.h5ad\
--h5ad_species mmusculus\
--cov_file lmmp_covar.tsv\
--gs_file magma_10kb_1000.74_traits.gs\
--gs_species hsapiens\
--ctrl_match_opt mean_var\
--weight_opt vs\
--flag_filter True\
--flag_raw_count True\
--n_ctrl 1000\
--flag_return_ctrl_raw_score False\
--flag_return_ctrl_norm_score True\
--out_folder out

Load data:
--h5ad_file loaded: n_cell=35537, n_gene=16078 (sys_time=7.7s)
--cov_file loaded: covariates=[batch, num_genes_expressed] (sys_time=7.8s)
Regress out covariates from --h5ad_file (sys_time=30.7s)
--gs_file loaded: n_geneset=74 (sys_time=30.7s)
--gs_file converted from hsapiens to mmusculus genes (sys_time=30.9s)

Compute cell-level and gene-level statistics:

Compute: score:
Gene set PASS_ADHD_Demontis2018 (n_gene=735): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=1285.3s)
Gene set PASS_Alzheimers_Jansen2019 (n_gene=705): 5/35537 FDR<0.1 cells, 27/35537 FDR<0.2 cells (sys_time=2469.1s)
Gene set PASS_AtrialFibrillation_Nielsen2018 (n_gene=762): 1/35537 FDR<0.1 cells, 6/35537 FDR<0.2 cells (sys_time=3728.5s)
Gene set PASS_BIP_Stahl2019 (n_gene=755): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=4979.3s)
Gene set PASS_CD_deLange2017 (n_gene=738): 92/35537 FDR<0.1 cells, 198/35537 FDR<0.2 cells (sys_time=6203.8s)
Gene set PASS_Celiac (n_gene=699): 1/35537 FDR<0.1 cells, 1/35537 FDR<0.2 cells (sys_time=7377.9s)
Gene set PASS_Coronary_Artery_Disease (n_gene=745): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=8611.2s)
Gene set PASS_DrinksPerWeek_Liu2019 (n_gene=737): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=9837.1s)
Gene set PASS_FastingGlucose_Manning (n_gene=743): 0/35537 FDR<0.1 cells, 1/35537 FDR<0.2 cells (sys_time=11072.5s)
Gene set PASS_GeneralRiskTolerance_KarlssonLinner2019 (n_gene=761): 5/35537 FDR<0.1 cells, 15/35537 FDR<0.2 cells (sys_time=12332.1s)
Gene set PASS_IBD_deLange2017 (n_gene=729): 125/35537 FDR<0.1 cells, 209/35537 FDR<0.2 cells (sys_time=13549.6s)
Gene set PASS_Insomnia_Jansen2019 (n_gene=745): 101/35537 FDR<0.1 cells, 206/35537 FDR<0.2 cells (sys_time=14782.0s)
Gene set PASS_Intelligence_SavageJansen2018 (n_gene=768): 4/35537 FDR<0.1 cells, 63/35537 FDR<0.2 cells (sys_time=16047.6s)
Gene set PASS_Lupus (n_gene=745): 53/35537 FDR<0.1 cells, 99/35537 FDR<0.2 cells (sys_time=17284.4s)
Gene set PASS_MDD_Howard2019 (n_gene=750): 145/35537 FDR<0.1 cells, 291/35537 FDR<0.2 cells (sys_time=18530.5s)
Gene set PASS_Multiple_sclerosis (n_gene=746): 188/35537 FDR<0.1 cells, 323/35537 FDR<0.2 cells (sys_time=19770.7s)
Gene set PASS_Primary_biliary_cirrhosis (n_gene=751): 5/35537 FDR<0.1 cells, 51/35537 FDR<0.2 cells (sys_time=21019.1s)
Gene set PASS_ReactionTime_Davies2018 (n_gene=768): 17/35537 FDR<0.1 cells, 141/35537 FDR<0.2 cells (sys_time=22283.5s)
Gene set PASS_Rheumatoid_Arthritis (n_gene=714): 138/35537 FDR<0.1 cells, 180/35537 FDR<0.2 cells (sys_time=23481.7s)
Gene set PASS_SWB (n_gene=744): 302/35537 FDR<0.1 cells, 594/35537 FDR<0.2 cells (sys_time=24715.8s)
Gene set PASS_Schizophrenia_Pardinas2018 (n_gene=775): 96/35537 FDR<0.1 cells, 220/35537 FDR<0.2 cells (sys_time=25992.3s)
Gene set PASS_SleepDuration_Dashti2019 (n_gene=770): 145/35537 FDR<0.1 cells, 241/35537 FDR<0.2 cells (sys_time=27263.2s)
Gene set PASS_Type_1_Diabetes (n_gene=728): 2/35537 FDR<0.1 cells, 2/35537 FDR<0.2 cells (sys_time=28480.3s)
Gene set PASS_Type_2_Diabetes (n_gene=751): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=29725.9s)
Gene set PASS_UC_deLange2017 (n_gene=720): 62/35537 FDR<0.1 cells, 136/35537 FDR<0.2 cells (sys_time=30928.2s)
Gene set PASS_VerbalNumericReasoning_Davies2018 (n_gene=776): 67/35537 FDR<0.1 cells, 148/35537 FDR<0.2 cells (sys_time=32205.5s)
Gene set PASS_Worry_Nagel2018 (n_gene=766): 139/35537 FDR<0.1 cells, 294/35537 FDR<0.2 cells (sys_time=33466.6s)
Gene set UKB_460K.biochemistry_AlanineAminotransferase (n_gene=768): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=34731.9s)
Gene set UKB_460K.biochemistry_AlkalinePhosphatase (n_gene=758): 10/35537 FDR<0.1 cells, 39/35537 FDR<0.2 cells (sys_time=35982.9s)
Gene set UKB_460K.biochemistry_Cholesterol (n_gene=742): 27/35537 FDR<0.1 cells, 101/35537 FDR<0.2 cells (sys_time=37211.1s)
Gene set UKB_460K.biochemistry_Glucose (n_gene=747): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=38450.8s)
Gene set UKB_460K.biochemistry_HDLcholesterol (n_gene=720): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=39649.4s)
Gene set UKB_460K.biochemistry_HbA1c (n_gene=750): 0/35537 FDR<0.1 cells, 4/35537 FDR<0.2 cells (sys_time=40888.1s)
Gene set UKB_460K.biochemistry_LDLdirect (n_gene=761): 3/35537 FDR<0.1 cells, 12/35537 FDR<0.2 cells (sys_time=42140.6s)
Gene set UKB_460K.biochemistry_SHBG (n_gene=759): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=43395.2s)
Gene set UKB_460K.biochemistry_Testosterone_Male (n_gene=736): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=44615.5s)
Gene set UKB_460K.biochemistry_TotalBilirubin (n_gene=733): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=45829.4s)
Gene set UKB_460K.biochemistry_TotalProtein (n_gene=776): 197/35537 FDR<0.1 cells, 351/35537 FDR<0.2 cells (sys_time=47095.5s)
Gene set UKB_460K.biochemistry_Triglycerides (n_gene=774): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=48362.8s)
Gene set UKB_460K.blood_EOSINOPHIL_COUNT (n_gene=760): 387/35537 FDR<0.1 cells, 551/35537 FDR<0.2 cells (sys_time=49613.3s)
Gene set UKB_460K.blood_LYMPHOCYTE_COUNT (n_gene=737): 232/35537 FDR<0.1 cells, 371/35537 FDR<0.2 cells (sys_time=50828.0s)
Gene set UKB_460K.blood_MEAN_CORPUSCULAR_HEMOGLOBIN (n_gene=755): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=52067.0s)
Gene set UKB_460K.blood_MONOCYTE_COUNT (n_gene=737): 222/35537 FDR<0.1 cells, 353/35537 FDR<0.2 cells (sys_time=53285.9s)
Gene set UKB_460K.blood_PLATELET_COUNT (n_gene=768): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=54544.1s)
Gene set UKB_460K.blood_RBC_DISTRIB_WIDTH (n_gene=742): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=55767.7s)
Gene set UKB_460K.blood_RED_COUNT (n_gene=760): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=57018.9s)
Gene set UKB_460K.blood_WHITE_COUNT (n_gene=773): 158/35537 FDR<0.1 cells, 274/35537 FDR<0.2 cells (sys_time=58282.4s)
Gene set UKB_460K.bmd_HEEL_TSCOREz (n_gene=775): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=59544.7s)
Gene set UKB_460K.body_BALDING1 (n_gene=746): 0/35537 FDR<0.1 cells, 5/35537 FDR<0.2 cells (sys_time=60769.0s)
Gene set UKB_460K.body_BMIz (n_gene=806): 263/35537 FDR<0.1 cells, 444/35537 FDR<0.2 cells (sys_time=62076.6s)
Gene set UKB_460K.body_HEIGHTz (n_gene=753): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=63310.3s)
Gene set UKB_460K.body_WHRadjBMIz (n_gene=773): 8/35537 FDR<0.1 cells, 21/35537 FDR<0.2 cells (sys_time=64572.8s)
Gene set UKB_460K.bp_DIASTOLICadjMEDz (n_gene=774): 17/35537 FDR<0.1 cells, 86/35537 FDR<0.2 cells (sys_time=65843.4s)
Gene set UKB_460K.bp_SYSTOLICadjMEDz (n_gene=767): 0/35537 FDR<0.1 cells, 13/35537 FDR<0.2 cells (sys_time=67103.9s)
Gene set UKB_460K.cancer_BREAST (n_gene=703): 0/35537 FDR<0.1 cells, 2/35537 FDR<0.2 cells (sys_time=68284.7s)
Gene set UKB_460K.cov_EDU_COLLEGE (n_gene=763): 146/35537 FDR<0.1 cells, 330/35537 FDR<0.2 cells (sys_time=69545.7s)
Gene set UKB_460K.cov_EDU_YEARS (n_gene=749): 276/35537 FDR<0.1 cells, 492/35537 FDR<0.2 cells (sys_time=70783.2s)
Gene set UKB_460K.cov_SMOKING_STATUS (n_gene=762): 2/35537 FDR<0.1 cells, 21/35537 FDR<0.2 cells (sys_time=72042.5s)
Gene set UKB_460K.disease_AID_ALL (n_gene=751): 288/35537 FDR<0.1 cells, 390/35537 FDR<0.2 cells (sys_time=73284.4s)
Gene set UKB_460K.disease_ALLERGY_ECZEMA_DIAGNOSED (n_gene=729): 77/35537 FDR<0.1 cells, 149/35537 FDR<0.2 cells (sys_time=74497.0s)
Gene set UKB_460K.disease_ASTHMA_DIAGNOSED (n_gene=752): 10/35537 FDR<0.1 cells, 35/35537 FDR<0.2 cells (sys_time=75742.9s)
Gene set UKB_460K.disease_CARDIOVASCULAR (n_gene=759): 0/35537 FDR<0.1 cells, 4/35537 FDR<0.2 cells (sys_time=76993.6s)
Gene set UKB_460K.disease_HYPERTENSION_DIAGNOSED (n_gene=754): 0/35537 FDR<0.1 cells, 2/35537 FDR<0.2 cells (sys_time=78238.7s)
Gene set UKB_460K.disease_HYPOTHYROIDISM_SELF_REP (n_gene=762): 352/35537 FDR<0.1 cells, 488/35537 FDR<0.2 cells (sys_time=79495.0s)
Gene set UKB_460K.disease_RESPIRATORY_ENT (n_gene=746): 11/35537 FDR<0.1 cells, 14/35537 FDR<0.2 cells (sys_time=80736.3s)
Gene set UKB_460K.impedance_BASAL_METABOLIC_RATEz (n_gene=784): 1/35537 FDR<0.1 cells, 4/35537 FDR<0.2 cells (sys_time=82021.9s)
Gene set UKB_460K.lung_FEV1FVCzSMOKE (n_gene=817): 25/35537 FDR<0.1 cells, 177/35537 FDR<0.2 cells (sys_time=83346.6s)
Gene set UKB_460K.lung_FVCzSMOKE (n_gene=783): 0/35537 FDR<0.1 cells, 7/35537 FDR<0.2 cells (sys_time=84628.9s)
Gene set UKB_460K.mental_NEUROTICISM (n_gene=778): 213/35537 FDR<0.1 cells, 377/35537 FDR<0.2 cells (sys_time=85903.3s)
Gene set UKB_460K.other_MORNINGPERSON (n_gene=733): 249/35537 FDR<0.1 cells, 396/35537 FDR<0.2 cells (sys_time=87117.3s)
Gene set UKB_460K.pigment_HAIR (n_gene=722): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=88316.3s)
Gene set UKB_460K.repro_MENARCHE_AGE (n_gene=756): 7/35537 FDR<0.1 cells, 44/35537 FDR<0.2 cells (sys_time=89559.9s)
Gene set UKB_460K.repro_MENOPAUSE_AGE (n_gene=749): 0/35537 FDR<0.1 cells, 0/35537 FDR<0.2 cells (sys_time=90791.7s)
Gene set UKB_460K.repro_NumberChildrenEverBorn_Pooled (n_gene=760): 0/35537 FDR<0.1 cells, 36/35537 FDR<0.2 cells (sys_time=92038.1s)
